package {{.PackageName}}

// GENERATED CODE, EDITS WILL BE LOST
//
// generated from {{.PackageName}}/{{.TypeName}}
// using http://github.com/brianstarke/go-beget

import (
	"database/sql"

	"github.com/lann/squirrel"
)

{{$numFields := len .InsertFields}}

var insertColumns{{.TypeName}} = []string{
	{{range $i, $x := .InsertFields}}"{{$x.DbName}}",
	{{end}}
}

// Create{{.TypeName}} inserts a {{.TypeName}} in to the database
func (c *{{.TypeName}}) Create{{.TypeName}}(db *sql.DB) (int64, error) {
	query := squirrel.Insert("{{.TableName}}").
		Columns(insertColumns{{.TypeName}}...).
		Values({{range $i, $x := .InsertFields}}c.{{$x.Name}}{{if lt $i $numFields}},{{end}}{{end}}).
		Suffix("RETURNING \"id\"").
		RunWith(db).
		PlaceholderFormat(squirrel.Dollar)

	var id int64

	err := query.QueryRow().Scan(&id)

	return id, err
}
